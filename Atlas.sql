SET SERVEROUTPUT ON;

/*
    
    SCRIPT BASE DE DATOS CLINIC CARE
    LENGUAJE DE BASE DE DATOS
    GRUPO ATLAS
    
    INTEGRANTES:
    Athuro Chaves Aguilar
    Catalina Chaves Aguilar 
    David Rodriguez Castillo
    Mathias Jimenes Prendas
    
*/

--Creacion de Tablas

CREATE TABLE PACIENTES (
    ID_PACIENTE NUMBER PRIMARY KEY,
    NOMBRE VARCHAR2(50),
    APELLIDO VARCHAR2(50),
    FECHA_NACIMIENTO DATE,
    GENERO CHAR(1),
    DIRECCION VARCHAR2(200),
    TELEFONO VARCHAR2(15),
    CORREO_ELECTRONICO VARCHAR2(100)
);


CREATE TABLE EMPLEADOS (
    ID_EMPLEADO NUMBER PRIMARY KEY,
    NOMBRE_EMPLEADO VARCHAR2(50),
    APELLIDO_EMPLEADO VARCHAR2(50),
    CARGO VARCHAR2(50),
    FECHA_CONTRATACION DATE,
    SALARIO NUMBER(10,2)
);

CREATE TABLE PROVEEDORES (
    ID_PROVEEDOR NUMBER PRIMARY KEY,
    NOMBRE_PROVEEDOR VARCHAR2 (50),
    DIRECCION VARCHAR2(100),
    CORREO_PROVEEDOR VARCHAR2(100)
);

CREATE TABLE PRODUCTOS (
    ID_PRODUCTO NUMBER PRIMARY KEY,
    ID_PROVEEDOR NUMBER,
    CANTIDAD NUMBER,
    DESCRIPCION VARCHAR2(100),
    PRECIO_PRODUCTO NUMBER(10,2),
    FOREIGN KEY (ID_PROVEEDOR) REFERENCES PROVEEDORES(ID_PROVEEDOR)
);

CREATE TABLE TRATAMIENTOS (
    ID_TRATAMIENTO NUMBER PRIMARY KEY,
    ID_PRODUCTO NUMBER,
    DESCRIPCION VARCHAR2(100),
    DURACION_ESTIMADA NUMBER,
    PRECIO_TRATAMIENTO NUMBER(10,2),
    FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTOS(ID_PRODUCTO)
);

CREATE TABLE CITAS (
    ID_CITA NUMBER PRIMARY KEY,
    ID_PACIENTE NUMBER,
    ID_EMPLEADO NUMBER,
    ID_TRATAMIENTO NUMBER,
    FECHA_CITA DATE,
    HORA_CITA TIMESTAMP,
    OBSERVACIONES VARCHAR2(200),
    FOREIGN KEY (ID_PACIENTE) REFERENCES PACIENTES(ID_PACIENTE),
    FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADOS(ID_EMPLEADO),
    FOREIGN KEY (ID_TRATAMIENTO) REFERENCES TRATAMIENTOS(ID_TRATAMIENTO)
);

CREATE TABLE FACTURAS (
    ID_FACTURA NUMBER PRIMARY KEY,
    ID_CITA NUMBER,
    FECHA_EMISION DATE,
    SUBTOTAL NUMBER(10, 2),
    IMPUESTOS NUMBER(10, 2),
    TOTAL NUMBER(10, 2),
    FOREIGN KEY (ID_CITA) REFERENCES CITAS(ID_CITA)
);

--Insercion a Tablas



INSERT INTO PACIENTES (ID_PACIENTE, NOMBRE, APELLIDO, FECHA_NACIMIENTO, GENERO, DIRECCION, TELEFONO, CORREO_ELECTRONICO)
VALUES (1, 'Juan', 'Perez', TO_DATE('1990-01-15','YYYY-MM-DD'), 'M', 'Calle Falsa 123, Ciudad X', '1234567890', 'juan.perez@mail.com');

INSERT INTO PACIENTES (ID_PACIENTE, NOMBRE, APELLIDO, FECHA_NACIMIENTO, GENERO, DIRECCION, TELEFONO, CORREO_ELECTRONICO)
VALUES (2, 'Ana', 'Gomez', TO_DATE('1985-05-25','YYYY-MM-DD'), 'F', 'Avenida Real 456, Ciudad Y', '0987654321', 'ana.gomez@mail.com');

INSERT INTO PACIENTES (ID_PACIENTE, NOMBRE, APELLIDO, FECHA_NACIMIENTO, GENERO, DIRECCION, TELEFONO, CORREO_ELECTRONICO)
VALUES (3, 'Carlos', 'Lopez', TO_DATE('1975-10-05','YYYY-MM-DD'), 'M', 'Bulevar Sol 789, Ciudad Z', '1112223334', 'carlos.lopez@mail.com');

INSERT INTO PACIENTES (ID_PACIENTE, NOMBRE, APELLIDO, FECHA_NACIMIENTO, GENERO, DIRECCION, TELEFONO, CORREO_ELECTRONICO)
VALUES (4, 'Maria', 'Sanchez', TO_DATE('1999-04-30','YYYY-MM-DD'), 'F', 'Callejon Oscuro 321, Ciudad A', '5554443332', 'maria.sanchez@mail.com');

INSERT INTO PACIENTES (ID_PACIENTE, NOMBRE, APELLIDO, FECHA_NACIMIENTO, GENERO, DIRECCION, TELEFONO, CORREO_ELECTRONICO)
VALUES (5, 'Jose', 'Martinez', TO_DATE('1980-07-20','YYYY-MM-DD'), 'M', 'Paseo Luna 654, Ciudad B', '6667778889', 'jose.martinez@mail.com');



INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE_EMPLEADO, APELLIDO_EMPLEADO, CARGO, FECHA_CONTRATACION, SALARIO)
VALUES (1, 'Luis', 'Gonzalez', 'Recepcionista', TO_DATE('2010-05-01','YYYY-MM-DD'), 7000.00);

INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE_EMPLEADO, APELLIDO_EMPLEADO, CARGO, FECHA_CONTRATACION, SALARIO)
VALUES (2, 'Laura', 'Fernandez', 'Enfermera', TO_DATE('2015-08-15','YYYY-MM-DD'), 5000.00);

INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE_EMPLEADO, APELLIDO_EMPLEADO, CARGO, FECHA_CONTRATACION, SALARIO)
VALUES (3, 'Andrea', 'Ramirez', 'Doctora', TO_DATE('2005-10-10','YYYY-MM-DD'), 7500.00);

INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE_EMPLEADO, APELLIDO_EMPLEADO, CARGO, FECHA_CONTRATACION, SALARIO)
VALUES (4, 'Isabel', 'Morales', 'Enfermera', TO_DATE('2012-03-20','YYYY-MM-DD'), 5500.00);

INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE_EMPLEADO, APELLIDO_EMPLEADO, CARGO, FECHA_CONTRATACION, SALARIO)
VALUES (5, 'David', 'Castillo', 'Doctor', TO_DATE('2018-06-01','YYYY-MM-DD'), 7200.00);



INSERT INTO PROVEEDORES (ID_PROVEEDOR, NOMBRE_PROVEEDOR, DIRECCION, CORREO_PROVEEDOR)
VALUES (1, 'Proveedora XYZ', 'Calle Industria 123, Ciudad X', 'contacto@proveedoraXYZ.com');

INSERT INTO PROVEEDORES (ID_PROVEEDOR, NOMBRE_PROVEEDOR, DIRECCION, CORREO_PROVEEDOR)
VALUES (2, 'Suplidora ABC', 'Avenida Comercio 456, Ciudad Y', 'info@suplidoraABC.com');

INSERT INTO PROVEEDORES (ID_PROVEEDOR, NOMBRE_PROVEEDOR, DIRECCION, CORREO_PROVEEDOR)
VALUES (3, 'Distribuidora LMN', 'Bulevar Negocios 789, Ciudad Z', 'atencion@distribuidoraLMN.com');

INSERT INTO PROVEEDORES (ID_PROVEEDOR, NOMBRE_PROVEEDOR, DIRECCION, CORREO_PROVEEDOR)
VALUES (4, 'Abastecedora RST', 'Callejon Servicios 321, Ciudad A', 'clientes@abastecedoraRST.com');

INSERT INTO PROVEEDORES (ID_PROVEEDOR, NOMBRE_PROVEEDOR, DIRECCION, CORREO_PROVEEDOR)
VALUES (5, 'Proveedor JKL', 'Paseo Ventas 654, Ciudad B', 'soporte@proveedorJKL.com');



INSERT INTO PRODUCTOS (ID_PRODUCTO, ID_PROVEEDOR, CANTIDAD, DESCRIPCION, PRECIO_PRODUCTO)
VALUES (1, 1, 50, 'Medicamento A', 20.00);

INSERT INTO PRODUCTOS (ID_PRODUCTO, ID_PROVEEDOR, CANTIDAD, DESCRIPCION, PRECIO_PRODUCTO)
VALUES (2, 2, 100, 'Medicamento B', 15.50);

INSERT INTO PRODUCTOS (ID_PRODUCTO, ID_PROVEEDOR, CANTIDAD, DESCRIPCION, PRECIO_PRODUCTO)
VALUES (3, 3, 200, 'Medicamento C', 25.30);

INSERT INTO PRODUCTOS (ID_PRODUCTO, ID_PROVEEDOR, CANTIDAD, DESCRIPCION, PRECIO_PRODUCTO)
VALUES (4, 4, 150, 'Medicamento D', 22.10);

INSERT INTO PRODUCTOS (ID_PRODUCTO, ID_PROVEEDOR, CANTIDAD, DESCRIPCION, PRECIO_PRODUCTO)
VALUES (5, 5, 175, 'Medicamento E', 18.75);



INSERT INTO TRATAMIENTOS (ID_TRATAMIENTO, ID_PRODUCTO, DESCRIPCION, DURACION_ESTIMADA, PRECIO_TRATAMIENTO)
VALUES (1, 1, 'Tratamiento para la condición X', 30, 120.00);

INSERT INTO TRATAMIENTOS (ID_TRATAMIENTO, ID_PRODUCTO, DESCRIPCION, DURACION_ESTIMADA, PRECIO_TRATAMIENTO)
VALUES (2, 2, 'Tratamiento para la condición Y', 45, 200.00);

INSERT INTO TRATAMIENTOS (ID_TRATAMIENTO, ID_PRODUCTO, DESCRIPCION, DURACION_ESTIMADA, PRECIO_TRATAMIENTO)
VALUES (3, 3, 'Tratamiento para la condición Z', 60, 300.00);

INSERT INTO TRATAMIENTOS (ID_TRATAMIENTO, ID_PRODUCTO, DESCRIPCION, DURACION_ESTIMADA, PRECIO_TRATAMIENTO)
VALUES (4, 4, 'Tratamiento para la condición A', 20, 100.00);

INSERT INTO TRATAMIENTOS (ID_TRATAMIENTO, ID_PRODUCTO, DESCRIPCION, DURACION_ESTIMADA, PRECIO_TRATAMIENTO)
VALUES (5, 5, 'Tratamiento para la condición B', 40, 150.00);



INSERT INTO CITAS (ID_CITA, ID_PACIENTE, ID_EMPLEADO, ID_TRATAMIENTO, FECHA_CITA, HORA_CITA, OBSERVACIONES)
VALUES (1, 1, 1, 1, TO_DATE('2023-07-20', 'YYYY-MM-DD'), TO_TIMESTAMP('08:00:00', 'HH24:MI:SS'), 'Primera cita');

INSERT INTO CITAS (ID_CITA, ID_PACIENTE, ID_EMPLEADO, ID_TRATAMIENTO, FECHA_CITA, HORA_CITA, OBSERVACIONES)
VALUES (2, 2, 2, 2, TO_DATE('2023-07-21', 'YYYY-MM-DD'), TO_TIMESTAMP('09:00:00', 'HH24:MI:SS'), 'Cita de seguimiento');

INSERT INTO CITAS (ID_CITA, ID_PACIENTE, ID_EMPLEADO, ID_TRATAMIENTO, FECHA_CITA, HORA_CITA, OBSERVACIONES)
VALUES (3, 3, 3, 3, TO_DATE('2023-07-22', 'YYYY-MM-DD'), TO_TIMESTAMP('10:00:00', 'HH24:MI:SS'), 'Consulta general');

INSERT INTO CITAS (ID_CITA, ID_PACIENTE, ID_EMPLEADO, ID_TRATAMIENTO, FECHA_CITA, HORA_CITA, OBSERVACIONES)
VALUES (4, 4, 4, 4, TO_DATE('2023-07-23', 'YYYY-MM-DD'), TO_TIMESTAMP('11:00:00', 'HH24:MI:SS'), 'Revisión de tratamiento');

INSERT INTO CITAS (ID_CITA, ID_PACIENTE, ID_EMPLEADO, ID_TRATAMIENTO, FECHA_CITA, HORA_CITA, OBSERVACIONES)
VALUES (5, 5, 5, 5, TO_DATE('2023-07-24', 'YYYY-MM-DD'), TO_TIMESTAMP('12:00:00', 'HH24:MI:SS'), 'Cita de emergencia');



INSERT INTO FACTURAS (ID_FACTURA, ID_CITA, FECHA_EMISION, SUBTOTAL, IMPUESTOS, TOTAL)
VALUES (1, 1, TO_DATE('2023-07-20', 'YYYY-MM-DD'), 100.00, 20.00, 120.00);

INSERT INTO FACTURAS (ID_FACTURA, ID_CITA, FECHA_EMISION, SUBTOTAL, IMPUESTOS, TOTAL)
VALUES (2, 2, TO_DATE('2023-07-21', 'YYYY-MM-DD'), 150.00, 30.00, 180.00);

INSERT INTO FACTURAS (ID_FACTURA, ID_CITA, FECHA_EMISION, SUBTOTAL, IMPUESTOS, TOTAL)
VALUES (3, 3, TO_DATE('2023-07-22', 'YYYY-MM-DD'), 200.00, 40.00, 240.00);

INSERT INTO FACTURAS (ID_FACTURA, ID_CITA, FECHA_EMISION, SUBTOTAL, IMPUESTOS, TOTAL)
VALUES (4, 4, TO_DATE('2023-07-23', 'YYYY-MM-DD'), 250.00, 50.00, 300.00);

INSERT INTO FACTURAS (ID_FACTURA, ID_CITA, FECHA_EMISION, SUBTOTAL, IMPUESTOS, TOTAL)
VALUES (5, 5, TO_DATE('2023-07-24', 'YYYY-MM-DD'), 300.00, 60.00, 360.00);



--Creacion de Usuarios

CREATE USER C##ADMINISTRADOR IDENTIFIED BY administrador123;
GRANT DBA TO ADMINISTRADOR;

CREATE USER C##RECEPCIONISTA IDENTIFIED BY recepcionista123;
GRANT CREATE SESSION, CREATE TABLE, INSERT ANY TABLE, UPDATE ANY TABLE TO RECEPCIONISTA;

--Restricciones de Tablas Y Usuarios 



--25 Procedimientos Almacenados



--10 Vistas



--15 Funciones



--10 Paquetes



--5 Triggers



--15 Cursores



